{% extends "base/base.html" %}
{% load static %}
{% block content %}
  <link rel="stylesheet" href="{% static 'css/sidebar.css' %}">
  <link rel="stylesheet" href="{% static 'css/todos.css' %}">
  <link rel="stylesheet" href="{% static 'css/dropdown.css' %}">
  <link rel="stylesheet" href="{% static 'css/popup_form.css' %}">
  <div class="sidebar"></div>
  <div class="todo-container">
    <div class="todo-head">
      <h1 id="todos-label">Todos</h1>
      <a id="plus" class="todo-create" onclick="createTodo()"></a>
      <div class="create-form-popup">
        <form method="post" class="form-container" id="todo-create-form">
          <h1>Add Todo</h1>
          <label for="todo_title">
            <b>Task Title</b>
          </label>
          <input type="text" placeholder="Add a Title..." name="todo_title" required>
          <label for="todo_desc">
            <b>Task Description</b>
          </label>
          <input type="text" placeholder="Add a description..." name="todo_desc">
          <input type="submit" class="btn" value="Add">
          <button type="button" class="btn cancel-create">Close</button>
        </form>
      </div>
    </div>
    <div class="todo-list">
      {% if todos %}
        <div class="todo-list-container">
          {% for todo in todos %}
            <div class="todo-object-container">
              {% if todo.todo_is_finished == True %}
                <input class="chkbox"
                       id="{{ todo.id }}"
                       type="checkbox"
                       name="todo_is_finished"
                       value="1"
                       checked>
              {% else %}
                <input class="chkbox"
                       id="{{ todo.id }}"
                       type="checkbox"
                       name="todo_is_finished"
                       value="0">
              {% endif %}
              <a id="todo-object-title" href={% url 'todo' todo.id %}>{{ todo.todo_title }}</a>
              <a onclick="showDropdown(this)" class="dropbtn" id="{{ todo.id }}">···</a>
              <div id="dropdown-{{ todo.id }}" class="dropdown-content">
                <a class="todo-update-{{ todo.id }}" onclick="updateTodo(this)">Edit</a>
                <a data-url="{% url 'todo-delete' todo.id %}" onclick="deleteTodo(this)">Delete</a>
                <a href="#">Set a Reminder</a>
              </div>
              <div class="update-form-popup-{{ todo.id }}">
                <form data-url="{% url 'todo-update' todo.id %}"
                      method="post"
                      class="form-container"
                      id="todo-update-form-{{ todo.id }}">
                  <h1>Edit Todo</h1>
                  <label for="todo_title">
                    <b>Task Title</b>
                  </label>
                  <input type="text" value="{{ todo.todo_title }}" name="todo_title" required>
                  <label for="todo_desc">
                    <b>Task Description</b>
                  </label>
                  <input type="text" value="{{ todo.todo_desc }}" name="todo_desc">
                  <input type="submit" class="btn" value="Update">
                  <button type="button" class="btn cancel-{{ todo.id }}">Close</button>
                </form>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p>Nothing to do.</p>
      {% endif %}
    </div>
    <script type="text/javascript">
      var csrftoken = '{{csrf_token}}'
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'js/dropdown.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/update.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/create.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/delete.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/checkbox.js' %}"></script>
  </div>
  <a href={% url 'logout' %} style="float:right; margin-right: 30px;">Logout</a>
{% endblock content %}
